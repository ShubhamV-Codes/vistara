<% layout('/layouts/boilerplate') %>

<div class="container mt-5">
  <!-- Profile Header -->
  <div class="profile-header text-center mb-5">
    <div class="profile-avatar">
      <%= user.username ? user.username.charAt(0).toUpperCase() : 'U' %>
    </div>
    <h2 class="glow-text"><%= user.username %></h2>
    <p class="text-muted"><%= user.email || 'user@vistara.com' %></p>
  </div>

  <!-- My Listings Section -->
  <div class="my-listings-section">
    <h3 class="mb-4 glow-text">My Listings</h3>

    <% if (listings.length > 0) { %>
      <div class="row g-4">
        <% listings.forEach(listing => { %>
          <div class="col-md-4">
            <div class="card h-100 shadow-hover">
              <img src="<%= listing.image?.url || 'https://images.unsplash.com/photo-1756916474898-a5bee9427163?q=80&w=1170&auto=format&fit=crop' %>" 
                   class="card-img-top" 
                   alt="<%= listing.title %>">
              <div class="card-body">
                <h5 class="card-title glow-text"><%= listing.title %></h5>
                <p class="card-text text-muted">
                  <i class="fa-solid fa-location-dot"></i> 
                  <%= listing.location || 'Unknown location' %>
                </p>
                <% if (listing.category) { %>
                  <span class="badge"><%= listing.category %></span>
                <% } %>
                <p class="fw-bold mt-2 glow-price">â‚¹<%= listing.price?.toLocaleString() %>/night</p>
              </div>
              <div class="card-footer d-flex justify-content-between">
                <a href="/listings/<%= listing._id %>/edit" class="btn btn-outline-primary btn-sm">
                  <i class="fa-solid fa-edit"></i> Edit
                </a>
                <form action="/listings/<%= listing._id %>?_method=DELETE" method="POST">
                  <button type="submit" class="btn btn-outline-danger btn-sm">
                    <i class="fa-solid fa-trash"></i> Delete
                  </button>
                </form>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } else { %>
      <div class="text-center text-muted mt-5 no-listings">
        <i class="fa-solid fa-house-circle-xmark fa-3x mb-3"></i>
        <p>No listings yet.</p>
        <a href="/listings/new" class="btn btn-outline-primary btn-lg mt-2">
          Create one now
        </a>
      </div>
    <% } %>
  </div>
</div>
